function getRelatedByID(a){return $.get(BASE_URL+"artists/"+a+"/related-artists").pipe(trimResults).pipe(renderRelatedTemplate)}function trimResults(a){return a.artists.length>RELATED_LIMIT&&(a.artists=a.artists.slice(0,RELATED_LIMIT)),a}function renderRelatedTemplate(a){console.log("relatedArtists: ",a),console.log("passed to template2: ",a.artists);var b=$relatedArtistTemplate.tmpl(a.artists);console.log("renderedTemplate: ",b),$("#relatedartists").html(b)}function searchArtists(a){var b={q:a,type:"artist",limit:SEARCH_LIMIT,offset:0,market:"US"},c=BASE_URL+"search";return $.get(c,b).pipe(renderSearchResults)}function renderSearchResults(a){searchResultData=a;for(var b=a.artists.items,c="",d=0;d<b.length;d++){var e=b[d].name,f=b[d].id;c+='<li><a class="artist" data-selected-index="'+d+'" data-artist-name="'+e+'" href="'+f+'">'+e+"</a></li>"}$searchResults.html(c)}function justDisplayResponse(a){console.log("response: ",a)}function buildURL(a,b){var c="";for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];c+=encodeURIComponent(d)+"="+encodeURIComponent(e)+"&"}return c.length>0&&(c=c.substring(0,c.length-1),a=a+"?"+c),a}function getHashValue(a){var b=[],c=!1,d=window.location.href.split("#")[1];if(void 0!==d){d=d.split("&");for(var e=0;e<d.length;e++)b=d[e].split("="),b[0]===a&&(c=b[1])}return c}var SPOTIFY_SCOPES="playlist-read-private playlist-modify-public playlist-modify-private user-library-read user-library-modify user-read-private user-read-email",REDIRECT_URL="http://localhost/spotify-materialize/index.html",SPOTIFY_AUTHORIZE_URL="https://accounts.spotify.com/authorize",REQUEST_TOKEN_PARAMS={client_id:SPOTIFY_CLIENT_ID,response_type:"token",redirect_uri:REDIRECT_URL,scope:SPOTIFY_SCOPES,show_dialog:!0},BUILT_URL=buildURL(SPOTIFY_AUTHORIZE_URL,REQUEST_TOKEN_PARAMS),accessToken,tokenType,expiresIn,spotifyApi=new SpotifyWebApi,ls=new localStorageDB("spotify",localStorage);if(ls.isNew()&&(ls.createTable("userinfo",["country","display_name","email","external_urls","followers","href","type","images","product","uri"]),ls.createTable("logininfo",["accessToken","tokenType","retrieved","expires"]),ls.commit()),""!==window.location.hash){accessToken=getHashValue("access_token"),tokenType=getHashValue("token_type"),expiresIn=getHashValue("expires_in"),console.log("accessToken: ",accessToken),console.log("tokenType: ",tokenType),console.log("expiresIn: ",expiresIn);var retrieved=new Date,expires=new Date;expires.setSeconds(expires.getSeconds()+expiresIn),ls.insertOrUpdate("logininfo",{accessToken:accessToken},{accessToken:accessToken,tokenType:tokenType,retrieved:retrieved,expires:expires}),ls.commit(),spotifyApi.setAccessToken(accessToken),spotifyApi.getMe().then(function(a){console.log("Me: ",a)},function(a){console.error(a)}),spotifyApi.getUserPlaylists("peterthomaslane").then(function(a){console.log("User playlists",a)},function(a){console.error(a)})}var BASE_URL="https://api.spotify.com/v1/",SEARCH_LIMIT=5,RELATED_LIMIT=6,$ajaxlog=$("#ajaxlog"),$searchResults=$("#searchresults"),$selectedArtistTemplate=$("#selectedartisttemplate"),$relatedArtistTemplate=$("#relatedartisttemplate"),$spotifyResults=$("#spotifyresults"),searchResultData={};$(document).ajaxComplete(function(a,b,c){$ajaxlog.append("<li>Request Complete.</li>")}),$(document).ajaxError(function(a,b,c,d){$ajaxlog.append("<li>Error requesting page <b>"+c.url+"</b></li>"),$ajaxlog.append("<li>Error Thrown: <b>"+d+"</b></li>")}),$(document).ajaxSend(function(a,b,c){$ajaxlog.append("<li>Starting request at "+c.url+"</li>")}),$(document).ajaxStart(function(){$ajaxlog.append("<li>ajax call started</li>")}),$(document).ajaxStop(function(){$ajaxlog.append("<li>ajax call stopped</li>")}),$(document).ajaxSuccess(function(a,b,c){$ajaxlog.append("<li>Successful Request!</li>")}),$(".modal-trigger").leanModal(),$("#btnsearchartists").on("click",function(a){var b=$("#txtArtistSearch").val();b.length>2&&($searchResults.html(""),searchArtists(b))}),$("body").on("click",".artist",function(a){a.preventDefault(),selectedIndex=$(this).attr("data-selected-index"),selectedID=$(this).attr("href"),selectedArtistData=searchResultData.artists.items[selectedIndex],console.log("passed to template1: ",selectedArtistData);var b=$selectedArtistTemplate.tmpl(selectedArtistData);console.log("renderedTemplate: ",b),$spotifyResults.html(b),getRelatedByID(selectedID),$("#searchcard").addClass("hidden"),$("#hiddenrow").removeClass("hidden").addClass("animated bounceInDown")}),$("body").on("click","#searchagainbutton",function(a){$("#searchcard").removeClass("hidden").addClass("animated bounceInDown"),$("#hiddenrow").removeClass("animated bounceInDown").addClass("hidden")}),$("body").on("click","#spotifylogin",function(a){a.preventDefault(),console.log($(this).attr("id")+" clicked"),console.log(a),window.location=BUILT_URL}),searchArtists("Dave Matthews");
//# sourceMappingURL=main.min.js.map